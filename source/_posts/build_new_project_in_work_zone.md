---
title: 如何爲辦公區新建一個項目
category:
  - Anrom
tags:
  - Anrom
  - Android
date: 2015-01-16 13:01:56
description: "爲辦公區添加一個新項目時，需要編寫對應的配置文件和編譯文件。"
---
** 以com.android.UnlockSelect爲例 **
## 1. 在gerrit上新建一個項目
## 2. 將項目拷貝到package/apps/目錄下，即package/apps/UnlockSelect
## 3. 進入UnlockSelect目錄，爲他添加.gitignore   內容爲:
```
# built application files
*.apk
*.ap_

# files for the dex VM
*.dex

# Java class files
*.class

# generated files
bin/
gen/

# Local configuration file (sdk path, etc)
local.properties

# Eclipse project files
.classpath
.project

# Proguard folder generated by Eclipse
proguard/

# Intellij project files
*.iml
*.ipr
*.iws
.idea/

.settings/
libs/android-support-v4.jar
```

## 4. 進入UnlockSelect目錄，爲他添加Android.mk   

Android.mk的具體寫法可以上網找找，本項目的內容比較簡單，爲:
```
LOCAL_PATH:= $(call my-dir)
include $(CLEAR_VARS)

LOCAL_JAVA_LIBRARIES := bouncycastle conscrypt telephony-common telephony-msim
LOCAL_STATIC_JAVA_LIBRARIES := android-support-v4 android-support-v13 jsr305 libGoogleAnalyticsV2

LOCAL_MODULE_TAGS := optional

LOCAL_SRC_FILES := $(call all-java-files-under, src)
LOCAL_ASSET_DIR := $(LOCAL_PATH)/assets

LOCAL_PACKAGE_NAME := UnlockSelect
LOCAL_CERTIFICATE := platform
LOCAL_PRIVILEGED_MODULE := true

#LOCAL_PROGUARD_FLAG_FILES := proguard.flags

include $(BUILD_PACKAGE)

# Use the folloing include to make our test apk.
include $(call all-makefiles-under,$(LOCAL_PATH))
```

## 5. 在/vendor/cm/overlay/common/frameworks/base/core/res/res/values/config.xml中，爲這個項目添加兩個設定：

第一個添加在`<string-array name="config_disabledComponents" translatable="false">`標籤中，這個添加保證該項目不會在個人區出現。
```
    <string-array name="config_personalzonePackagesDisabled" translatable="false">
        <item>org.ancode.anrommarket
        <item>org.ancode.secsms
        <item>org.ancode.vpnmanager
        <item>org.ancode.ciphone
        <item>org.ancode.secmail
        <item>org.ancode.mixun
        <item>com.android.unlockselect</item>
    </string-array>
```

第二個添加在`<string-array name="config_workzonePackages" translatable="false">`標籤中，這個添加保證該項目會在辦公區出現。
```
        <item>com.UCMobile
        <item>com.android.unlockselect
    </string-array>  
```

## 6. 在.repo/manifests/default.xml中添加這個項目的信息，這個添加保證以後repo sync時，會遷下這個項目。
```
path="packages/apps/UnlockSelect" name="packages/apps/unlockselect" remote="anrom" revisi
on="anrom-4.0"/>
```

## 7. 在vendor/cm/config/commom.mk裏添加這個項目的信息

```
# Custom Anrom packages
PRODUCT_PACKAGES += \
    AnromMarket \
    AnromSandBox \
    AnromLockScreen \
    TaskKiller \
    VpnManager \
    ModeSwitch \
    UnlockSelect \
    SecMms
```